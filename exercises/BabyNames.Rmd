---
title: "Baby Names Investigation"
author: "Justin Post"
output: html_document
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dcData)
```


# Investigating Names

We’ll be investigating the popularity of names in the US each year. The names of interest are: 

- Justin
- Alexander
- Jacob
- Anderson
- George


# Read Data  

Let's read in some data to investigate!  We'll read in from two sources and combine the data into one object to look at.

```{r }
#from packages
data("BabyNames", package = "dcData")

#From file
BabyNamesSupp <- 
  read_csv("https://github.com/jbpost2/Basics-of-R-for-Data-Science-and-Statistics/raw/master/datasets/BabyNamesSupp.csv",
           col_types = cols(sex = col_character()))  # fixes `sex`

BabyNamesFull <- bind_rows(BabyNames, BabyNamesSupp)
```

Now let's subset the rows to only include names we have an interest in.

```{r}
BabyNamesFull %>%
  as_tibble() %>%
  filter(name %in% c("Justin", "Jacob", "Alexander", "George", "Anderson")) %>% 
  arrange(desc(count))

```

Jacob is very popular in the late 90's.

## George

Let's see how the name George has changed year to year by creating a new variable corresponding to the difference in count from one year to the next.  

```{r}
BabyNamesFull %>%
  filter(name == "George" & sex == "M") %>%
  mutate(diff = count - lag(count))

```

## Shannon and Lindsay  

Let's take a look at how these names have been used across time.

```{r}
BabyNamesFull %>%
  filter(name %in% c("Shannon", "Lindsay")) %>% 
  pivot_wider(names_from = sex, values_from = count) 

BabyNamesFull %>%
  filter(name %in% c("Shannon", "Lindsay")) %>% 
  pivot_wider(names_from = sex, values_from = count) %>% 
  group_by(name) %>%
  summarize(totalM = sum(M, na.rm = TRUE), totalF = sum(F, na.rm = TRUE))
```

## Some summaries!  

Let's find out how many babies have been named each of the names we were investigating earlier.  We'll investigate the total number of times these names come up by their sex as assigned at birth.  

```{r}
names <- c("Justin", "George", "Alexander", "Jacob", "Anderson")
BabyNamesFull %>%
    filter(name %in% names) %>%
    group_by(name, sex) %>%                          
    summarise(total = sum(count, na.rm = TRUE)) 
```

Now let's look at a contingency table of all names that occurred more than 50000 times in a given year.  This will let us know how often the names have been really popular in a given year.

```{r}
BabyNamesFull %>%
  filter(count >50000) %>% 
  pull(name) %>%
  table()
```



Let’s investigate the total number of names in each year. We'll group the data by year and find the sum of the count variable.  This will let us know how many babies have been born across the years.  

```{r}
BabyNamesFull %>% 
  group_by(year) %>%
  summarize(total = sum(count)) %>%
  pull(total) %>%
  summary()
```

## Visuals of the Data

Ok, now let's visualize the number of times the five names of interest we have show up!

First, we can create a summary data set that has the number of times each one shows.  

```{r}
names <- c("Justin", "George", "Alexander", "Jacob", "Anderson")
barData <- BabyNamesFull %>%
  filter(name %in% names) %>% 
  group_by(name) %>%
  summarise(total = sum(count))
barData
```

Next, we can use `geom_bar()` to plot this and look at it in a nicer way.

```{r}
ggplot(barData) +
 geom_bar(stat = "identity", aes(x = name, y = total)) 
```

Now let's do the same thing but fill the plot by the sex variable.

```{r}
barDataSex <- BabyNamesFull %>%
  filter(name %in% c("Shannon", "Lindsay", "Avery")) %>% 
  group_by(name, sex) %>%
  summarise(total = sum(count))
```

```{r, echo = FALSE}
ggplot(barDataSex) +
 geom_bar(stat = "identity", aes(x = name, y = total, fill = sex)) 
```

## Names over time

Ok, now let's look at how our names have changed in popularity over time.

```{r}
lineData <- BabyNamesFull %>%
  filter(name %in% names) %>% 
  group_by(name, year) %>%
  summarise(total = sum(count))

## `summarise()` has grouped output by 'name'. You can override using the `.groups` argument.

ggplot(lineData) +
 geom_line(aes(x = year, y = total, color = name)) 
```

